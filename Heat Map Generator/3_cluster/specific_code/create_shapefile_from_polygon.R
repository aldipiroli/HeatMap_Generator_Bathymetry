rm(list=ls()) #clear envirment var
cat("\014") #console clear
setwd(path.expand("/home/aldi/R-Dev/HeatMapper_v0.1/3_cluster/")) #set dir path

#---------------------------------------------------------------------------------------#
# Packages
library(stringr)
library(ggplot2)
library(mapdata)
library(maptools)
library("gpclib")
library(rgeos)
library(raster)
library(sp)
library(rgdal)


#datos <- read.csv(file="data/data.csv", header=TRUE, sep=",",quote = "",row.names = NULL, stringsAsFactors = FALSE)

datos <-structure(list(longitud = c(18.875, 19.125, 19.375, 18.375, 18.625,
                            18.875, 19.125, 19.375, 19.625, 19.875, 17.875, 18.125, 18.375,
                            18.625, 18.875, 19.125, 19.375, 19.625, 19.875, 20.125, 28.875,
                            29.125, 29.375, 17.125, 17.375, 17.625, 17.875, 18.125, 18.375,
                            18.625, 18.875, 19.125, 19.375, 19.625, 19.875, 20.125, 27.875,
                            28.125, 28.375, 28.625, 28.875, 29.125, 29.375, 29.625, 29.875,
                            32.625, 32.875, 33.625, 33.875, 15.875, 16.125, 16.375, 16.625,
                            16.875, 17.125, 17.375, 17.625, 17.875, 18.125, 18.375, 18.625,
                            18.875, 19.125, 19.375, 19.625, 19.875, 20.125, 27.125, 27.375,
                            27.625, 27.875, 28.125, 28.375, 28.625, 28.875, 29.125, 29.375,
                            29.625, 29.875, 30.125, 30.375, 32.125, 32.375, 32.625, 32.875,
                            33.125, 33.375, 33.625, 33.875, 34.125, 15.625, 15.875, 16.125,
                            16.375, 16.625, 16.875, 17.125, 17.375, 17.625, 17.875, 18.125,
                            18.375, 18.625, 18.875, 19.125, 19.375, 19.625, 19.875, 25.375,
                            25.625, 25.875, 26.125, 26.375, 26.625, 26.875, 27.125, 27.375,
                            27.625, 27.875, 28.125, 28.375, 28.625, 28.875, 29.125, 29.375,
                            29.625, 29.875, 30.125, 30.375, 30.625, 30.875, 31.125, 31.375,
                            31.625, 31.875, 32.125, 32.375, 32.625, 32.875, 33.125, 33.375,
                            33.625, 33.875, 34.125, 34.375, 15.375, 15.625, 15.875, 16.125,
                            16.375, 16.625, 16.875, 17.125, 17.375, 17.625, 17.875, 18.125,
                            18.375, 18.625, 18.875, 19.125, 19.375, 19.625, 19.875, 25.125,
                            25.375, 25.625, 25.875, 26.125, 26.375, 26.625, 26.875, 27.125,
                            27.375, 27.625, 27.875, 28.125, 28.375, 28.625, 28.875, 29.125,
                            29.375, 29.625, 29.875, 30.125, 30.375, 30.625, 30.875, 31.125,
                            31.375, 31.625, 31.875, 32.125, 32.375, 32.625, 32.875, 33.125,
                            33.375, 33.625, 33.875, 34.125, 34.375, 34.625, 15.375, 15.625,
                            15.875, 16.125, 16.375, 16.625, 16.875, 17.125, 17.375, 17.625,
                            17.875, 18.125, 18.375, 18.625, 18.875, 19.125, 19.375, 19.625,
                            19.875, 23.875, 24.125, 24.375, 24.625, 24.875, 25.125, 25.375,
                            25.625, 25.875, 26.125, 26.375, 26.625, 26.875, 27.125, 27.375,
                            27.625, 27.875, 28.125, 28.375, 28.625, 28.875, 29.125, 29.375,
                            29.625, 29.875, 30.125, 30.375, 30.625, 30.875, 31.125, 31.375,
                            31.625, 31.875, 32.125, 32.375, 32.625, 32.875, 33.125, 33.375,
                            33.625, 33.875, 34.125, 34.375, 34.625, 15.125, 15.375, 15.625,
                            15.875, 16.125, 16.375, 16.625, 16.875, 17.125, 17.375, 17.625,
                            17.875, 18.125, 18.375, 18.625, 18.875, 19.125, 19.375, 19.625,
                            19.875, 20.125, 20.375, 23.125, 23.375, 23.625, 23.875, 24.125,
                            24.375, 24.625, 24.875, 25.125, 25.375, 25.625, 25.875, 26.125,
                            26.375, 26.625, 26.875, 27.125, 27.375, 27.625, 27.875, 28.125,
                            28.375, 28.625, 28.875, 29.125, 29.375, 29.625, 29.875, 30.125,
                            30.375, 30.625, 30.875, 31.125, 31.375, 31.625, 31.875, 32.125,
                            32.375, 32.625, 32.875, 33.125, 33.375, 33.625, 33.875, 34.125,
                            34.375, 34.625, 34.875, 14.375, 14.625, 14.875, 15.125, 15.375,
                            15.625, 15.875, 16.125, 16.375, 16.625, 16.875, 17.125, 17.375,
                            17.625, 17.875, 18.125, 18.375, 18.625, 18.875, 19.125, 19.375,
                            19.625, 19.875, 20.125, 20.375, 20.625, 20.875, 23.125, 23.375,
                            23.625, 23.875, 24.125, 24.375, 24.625, 24.875, 25.125, 25.375,
                            25.625, 25.875, 26.125, 26.375, 26.625, 26.875, 27.125, 27.375,
                            27.625, 27.875, 28.125, 28.375, 28.625, 28.875, 29.125, 29.375,
                            29.625, 29.875, 30.125, 30.375, 30.625, 30.875, 31.125, 31.375,
                            31.625, 31.875, 32.125, 32.375, 32.625, 32.875, 33.125, 33.375,
                            33.625, 33.875, 34.125, 34.375, 34.625, 34.875, 12.375, 12.625,
                            12.875, 13.125, 13.375, 13.625, 13.875, 14.125, 14.375, 14.625,
                            14.875, 15.125, 15.375, 15.625, 15.875, 16.125, 16.375, 16.625,
                            16.875, 17.125, 17.375, 17.625, 17.875, 18.125, 18.375, 18.625,
                            18.875, 19.125, 19.375, 19.625, 19.875, 20.125, 20.375, 20.625,
                            20.875, 21.125, 21.375, 21.625, 22.375, 22.625, 22.875, 23.125,
                            23.375, 23.625, 23.875, 24.125, 24.375, 24.625, 24.875, 25.125,
                            25.375, 25.625, 25.875, 26.125, 26.375, 26.625, 26.875, 27.125,
                            27.375, 27.625, 27.875, 28.125, 28.375, 28.625, 28.875, 29.125,
                            29.375, 29.625, 29.875, 30.125, 30.375, 30.625, 30.875, 31.125,
                            31.375, 31.625, 31.875, 32.125, 32.375, 32.625, 32.875, 33.125,
                            33.375, 33.625, 33.875, 34.125, 34.375, 34.625, 34.875, 35.125,
                            11.625, 11.875, 12.125, 12.375, 12.625, 12.875, 13.125, 13.375,
                            13.625, 13.875, 14.125, 14.375, 14.625, 14.875, 15.125, 15.375,
                            15.625, 15.875, 16.125, 16.375, 16.625, 16.875, 17.125, 17.375,
                            17.625, 17.875, 18.125, 18.375, 18.625, 18.875, 19.125, 19.375,
                            19.625, 19.875, 20.125, 20.375, 20.625, 20.875, 21.125, 21.375,
                            21.625, 21.875, 22.125, 22.375, 22.625, 22.875, 23.125, 23.375,
                            23.625, 23.875, 24.125, 24.375, 24.625, 24.875, 25.125, 25.375,
                            25.625, 25.875, 26.125, 26.375, 26.625, 26.875, 27.125, 27.375,
                            27.625, 27.875, 28.125, 28.375, 28.625, 28.875, 29.125, 29.375,
                            29.625, 29.875, 30.125, 30.375, 30.625, 30.875, 31.125, 31.375,
                            31.625, 31.875, 32.125, 32.375, 32.625, 32.875, 33.125, 33.375,
                            33.625, 33.875, 34.125, 34.375, 34.625, 34.875, 35.125, 11.125,
                            11.375, 11.625, 11.875, 12.125, 12.375, 12.625, 12.875, 13.125,
                            13.375, 13.625, 13.875, 14.125, 14.375, 14.625, 14.875, 15.125,
                            15.375, 15.625, 15.875, 16.125, 16.375, 16.625, 16.875, 17.125,
                            17.375, 17.625, 17.875, 18.125, 18.375, 18.625, 18.875, 19.125,
                            19.375, 19.625, 19.875, 20.125, 20.375, 20.625, 20.875, 21.125,
                            21.375, 21.625, 21.875, 22.125, 22.375, 22.625, 22.875, 23.125,
                            23.375, 23.625, 23.875, 24.125, 24.375, 24.625, 24.875, 25.125,
                            25.375, 25.625, 25.875, 26.125, 26.375, 26.625, 26.875, 27.125,
                            27.375, 27.625, 27.875, 28.125, 28.375, 28.625, 28.875, 29.125,
                            29.375, 29.625, 29.875, 30.125, 30.375, 30.625, 30.875, 31.125,
                            31.375, 31.625, 31.875, 32.125, 32.375, 32.625, 32.875, 33.125,
                            33.375, 33.625, 33.875, 34.125, 34.375, 34.625, 34.875, 35.125,
                            10.875, 11.125, 11.375, 11.625, 11.875, 12.125, 12.375, 12.625,
                            12.875, 13.125, 13.375, 13.625, 13.875, 14.125, 14.375, 14.625,
                            14.875, 15.125, 15.375, 15.625, 15.875, 16.125, 16.375, 16.625,
                            16.875, 17.125, 17.375, 17.625, 17.875, 18.125, 18.375, 18.625,
                            18.875, 19.125, 19.375, 19.625, 19.875, 20.125, 20.375, 20.625,
                            20.875, 21.125, 21.375, 21.625, 21.875, 22.125, 22.375, 22.625,
                            22.875, 23.125, 23.375, 23.625, 23.875, 24.125, 24.375, 24.625,
                            24.875, 25.125, 25.375, 25.625, 25.875, 26.125, 26.375, 26.625,
                            26.875, 27.125, 27.375, 27.625, 27.875, 28.125, 28.375, 28.625,
                            28.875, 29.125, 29.375, 29.625, 29.875, 30.125, 30.375, 30.625,
                            30.875, 31.125, 31.375, 31.625, 31.875, 32.125, 32.375, 32.625,
                            32.875, 33.125, 33.375, 33.625, 33.875, 34.125, 34.375, 34.625,
                            34.875, 35.125, 35.375, 10.125, 10.375, 10.625, 10.875, 11.125,
                            11.375, 11.625, 11.875, 12.125, 12.375, 12.625, 12.875, 13.125,
                            13.375, 13.625, 13.875, 14.125, 14.375, 14.625, 14.875, 15.125,
                            15.375, 15.625, 15.875, 16.125, 16.375, 16.625, 16.875, 17.125,
                            17.375, 17.625, 17.875, 18.125, 18.375, 18.625, 18.875, 19.125,
                            19.375, 19.625, 19.875, 20.125, 20.375, 20.625, 20.875, 21.125,
                            21.375, 21.625, 21.875, 22.125, 22.375, 22.625, 22.875, 23.125,
                            23.375, 23.625, 23.875, 24.125, 24.375, 24.625, 24.875, 25.125,
                            25.375, 25.625, 25.875, 26.125, 26.375, 26.625, 26.875, 27.125,
                            27.375, 27.625, 27.875, 28.125, 28.375, 28.625, 28.875, 29.125,
                            29.375, 29.625, 29.875, 30.125, 30.375, 30.625, 30.875, 31.125,
                            31.375, 31.625, 31.875, 32.125, 32.375, 32.625, 32.875, 33.125,
                            33.375, 33.625, 33.875, 34.125, 34.375, 34.625, 34.875, 35.125,
                            35.375, 10.125, 10.375, 10.625, 10.875, 11.125, 11.375, 11.625,
                            11.875, 12.125, 12.375, 12.625, 12.875, 13.125, 13.375, 13.625,
                            13.875, 14.125, 14.375, 14.625, 14.875, 15.125, 15.375, 15.625,
                            15.875, 16.125, 16.375, 16.625, 16.875, 17.125, 17.375, 17.625,
                            17.875, 18.125, 18.375, 18.625, 18.875, 19.125, 19.375, 19.625,
                            19.875, 20.125, 20.375, 20.625, 20.875, 21.125, 21.375, 21.625,
                            21.875, 22.125, 22.375, 22.625, 22.875, 23.125, 23.375, 23.625,
                            23.875, 24.125, 24.375, 24.625, 24.875, 25.125, 25.375, 25.625,
                            25.875, 26.125, 26.375, 26.625, 26.875, 27.125, 27.375, 27.625,
                            27.875, 28.125, 28.375, 28.625, 28.875, 29.125, 29.375, 29.625,
                            29.875, 30.125, 30.375, 30.625, 30.875, 31.125, 31.375, 31.625,
                            31.875, 32.125, 32.375, 32.625, 32.875, 33.125, 33.375, 33.625,
                            33.875, 34.125, 34.375, 34.625, 34.875, 35.125, 35.375, 35.625,
                            10.375, 10.625, 10.875), latitud = c(30.375, 30.375, 30.375,
                                                                 30.625, 30.625, 30.625, 30.625, 30.625, 30.625, 30.625, 30.875,
                                                                 30.875, 30.875, 30.875, 30.875, 30.875, 30.875, 30.875, 30.875,
                                                                 30.875, 30.875, 30.875, 30.875, 31.125, 31.125, 31.125, 31.125,
                                                                 31.125, 31.125, 31.125, 31.125, 31.125, 31.125, 31.125, 31.125,
                                                                 31.125, 31.125, 31.125, 31.125, 31.125, 31.125, 31.125, 31.125,
                                                                 31.125, 31.125, 31.125, 31.125, 31.125, 31.125, 31.375, 31.375,
                                                                 31.375, 31.375, 31.375, 31.375, 31.375, 31.375, 31.375, 31.375,
                                                                 31.375, 31.375, 31.375, 31.375, 31.375, 31.375, 31.375, 31.375,
                                                                 31.375, 31.375, 31.375, 31.375, 31.375, 31.375, 31.375, 31.375,
                                                                 31.375, 31.375, 31.375, 31.375, 31.375, 31.375, 31.375, 31.375,
                                                                 31.375, 31.375, 31.375, 31.375, 31.375, 31.375, 31.375, 31.625,
                                                                 31.625, 31.625, 31.625, 31.625, 31.625, 31.625, 31.625, 31.625,
                                                                 31.625, 31.625, 31.625, 31.625, 31.625, 31.625, 31.625, 31.625,
                                                                 31.625, 31.625, 31.625, 31.625, 31.625, 31.625, 31.625, 31.625,
                                                                 31.625, 31.625, 31.625, 31.625, 31.625, 31.625, 31.625, 31.625,
                                                                 31.625, 31.625, 31.625, 31.625, 31.625, 31.625, 31.625, 31.625,
                                                                 31.625, 31.625, 31.625, 31.625, 31.625, 31.625, 31.625, 31.625,
                                                                 31.625, 31.625, 31.625, 31.625, 31.625, 31.625, 31.875, 31.875,
                                                                 31.875, 31.875, 31.875, 31.875, 31.875, 31.875, 31.875, 31.875,
                                                                 31.875, 31.875, 31.875, 31.875, 31.875, 31.875, 31.875, 31.875,
                                                                 31.875, 31.875, 31.875, 31.875, 31.875, 31.875, 31.875, 31.875,
                                                                 31.875, 31.875, 31.875, 31.875, 31.875, 31.875, 31.875, 31.875,
                                                                 31.875, 31.875, 31.875, 31.875, 31.875, 31.875, 31.875, 31.875,
                                                                 31.875, 31.875, 31.875, 31.875, 31.875, 31.875, 31.875, 31.875,
                                                                 31.875, 31.875, 31.875, 31.875, 31.875, 31.875, 31.875, 31.875,
                                                                 32.125, 32.125, 32.125, 32.125, 32.125, 32.125, 32.125, 32.125,
                                                                 32.125, 32.125, 32.125, 32.125, 32.125, 32.125, 32.125, 32.125,
                                                                 32.125, 32.125, 32.125, 32.125, 32.125, 32.125, 32.125, 32.125,
                                                                 32.125, 32.125, 32.125, 32.125, 32.125, 32.125, 32.125, 32.125,
                                                                 32.125, 32.125, 32.125, 32.125, 32.125, 32.125, 32.125, 32.125,
                                                                 32.125, 32.125, 32.125, 32.125, 32.125, 32.125, 32.125, 32.125,
                                                                 32.125, 32.125, 32.125, 32.125, 32.125, 32.125, 32.125, 32.125,
                                                                 32.125, 32.125, 32.125, 32.125, 32.125, 32.125, 32.125, 32.375,
                                                                 32.375, 32.375, 32.375, 32.375, 32.375, 32.375, 32.375, 32.375,
                                                                 32.375, 32.375, 32.375, 32.375, 32.375, 32.375, 32.375, 32.375,
                                                                 32.375, 32.375, 32.375, 32.375, 32.375, 32.375, 32.375, 32.375,
                                                                 32.375, 32.375, 32.375, 32.375, 32.375, 32.375, 32.375, 32.375,
                                                                 32.375, 32.375, 32.375, 32.375, 32.375, 32.375, 32.375, 32.375,
                                                                 32.375, 32.375, 32.375, 32.375, 32.375, 32.375, 32.375, 32.375,
                                                                 32.375, 32.375, 32.375, 32.375, 32.375, 32.375, 32.375, 32.375,
                                                                 32.375, 32.375, 32.375, 32.375, 32.375, 32.375, 32.375, 32.375,
                                                                 32.375, 32.375, 32.375, 32.375, 32.375, 32.625, 32.625, 32.625,
                                                                 32.625, 32.625, 32.625, 32.625, 32.625, 32.625, 32.625, 32.625,
                                                                 32.625, 32.625, 32.625, 32.625, 32.625, 32.625, 32.625, 32.625,
                                                                 32.625, 32.625, 32.625, 32.625, 32.625, 32.625, 32.625, 32.625,
                                                                 32.625, 32.625, 32.625, 32.625, 32.625, 32.625, 32.625, 32.625,
                                                                 32.625, 32.625, 32.625, 32.625, 32.625, 32.625, 32.625, 32.625,
                                                                 32.625, 32.625, 32.625, 32.625, 32.625, 32.625, 32.625, 32.625,
                                                                 32.625, 32.625, 32.625, 32.625, 32.625, 32.625, 32.625, 32.625,
                                                                 32.625, 32.625, 32.625, 32.625, 32.625, 32.625, 32.625, 32.625,
                                                                 32.625, 32.625, 32.625, 32.625, 32.625, 32.625, 32.625, 32.625,
                                                                 32.875, 32.875, 32.875, 32.875, 32.875, 32.875, 32.875, 32.875,
                                                                 32.875, 32.875, 32.875, 32.875, 32.875, 32.875, 32.875, 32.875,
                                                                 32.875, 32.875, 32.875, 32.875, 32.875, 32.875, 32.875, 32.875,
                                                                 32.875, 32.875, 32.875, 32.875, 32.875, 32.875, 32.875, 32.875,
                                                                 32.875, 32.875, 32.875, 32.875, 32.875, 32.875, 32.875, 32.875,
                                                                 32.875, 32.875, 32.875, 32.875, 32.875, 32.875, 32.875, 32.875,
                                                                 32.875, 32.875, 32.875, 32.875, 32.875, 32.875, 32.875, 32.875,
                                                                 32.875, 32.875, 32.875, 32.875, 32.875, 32.875, 32.875, 32.875,
                                                                 32.875, 32.875, 32.875, 32.875, 32.875, 32.875, 32.875, 32.875,
                                                                 32.875, 32.875, 32.875, 32.875, 32.875, 32.875, 32.875, 32.875,
                                                                 32.875, 32.875, 32.875, 32.875, 32.875, 32.875, 32.875, 32.875,
                                                                 32.875, 32.875, 33.125, 33.125, 33.125, 33.125, 33.125, 33.125,
                                                                 33.125, 33.125, 33.125, 33.125, 33.125, 33.125, 33.125, 33.125,
                                                                 33.125, 33.125, 33.125, 33.125, 33.125, 33.125, 33.125, 33.125,
                                                                 33.125, 33.125, 33.125, 33.125, 33.125, 33.125, 33.125, 33.125,
                                                                 33.125, 33.125, 33.125, 33.125, 33.125, 33.125, 33.125, 33.125,
                                                                 33.125, 33.125, 33.125, 33.125, 33.125, 33.125, 33.125, 33.125,
                                                                 33.125, 33.125, 33.125, 33.125, 33.125, 33.125, 33.125, 33.125,
                                                                 33.125, 33.125, 33.125, 33.125, 33.125, 33.125, 33.125, 33.125,
                                                                 33.125, 33.125, 33.125, 33.125, 33.125, 33.125, 33.125, 33.125,
                                                                 33.125, 33.125, 33.125, 33.125, 33.125, 33.125, 33.125, 33.125,
                                                                 33.125, 33.125, 33.125, 33.125, 33.125, 33.125, 33.125, 33.125,
                                                                 33.125, 33.125, 33.125, 33.125, 33.125, 33.125, 33.125, 33.125,
                                                                 33.125, 33.375, 33.375, 33.375, 33.375, 33.375, 33.375, 33.375,
                                                                 33.375, 33.375, 33.375, 33.375, 33.375, 33.375, 33.375, 33.375,
                                                                 33.375, 33.375, 33.375, 33.375, 33.375, 33.375, 33.375, 33.375,
                                                                 33.375, 33.375, 33.375, 33.375, 33.375, 33.375, 33.375, 33.375,
                                                                 33.375, 33.375, 33.375, 33.375, 33.375, 33.375, 33.375, 33.375,
                                                                 33.375, 33.375, 33.375, 33.375, 33.375, 33.375, 33.375, 33.375,
                                                                 33.375, 33.375, 33.375, 33.375, 33.375, 33.375, 33.375, 33.375,
                                                                 33.375, 33.375, 33.375, 33.375, 33.375, 33.375, 33.375, 33.375,
                                                                 33.375, 33.375, 33.375, 33.375, 33.375, 33.375, 33.375, 33.375,
                                                                 33.375, 33.375, 33.375, 33.375, 33.375, 33.375, 33.375, 33.375,
                                                                 33.375, 33.375, 33.375, 33.375, 33.375, 33.375, 33.375, 33.375,
                                                                 33.375, 33.375, 33.375, 33.375, 33.375, 33.375, 33.375, 33.375,
                                                                 33.375, 33.375, 33.625, 33.625, 33.625, 33.625, 33.625, 33.625,
                                                                 33.625, 33.625, 33.625, 33.625, 33.625, 33.625, 33.625, 33.625,
                                                                 33.625, 33.625, 33.625, 33.625, 33.625, 33.625, 33.625, 33.625,
                                                                 33.625, 33.625, 33.625, 33.625, 33.625, 33.625, 33.625, 33.625,
                                                                 33.625, 33.625, 33.625, 33.625, 33.625, 33.625, 33.625, 33.625,
                                                                 33.625, 33.625, 33.625, 33.625, 33.625, 33.625, 33.625, 33.625,
                                                                 33.625, 33.625, 33.625, 33.625, 33.625, 33.625, 33.625, 33.625,
                                                                 33.625, 33.625, 33.625, 33.625, 33.625, 33.625, 33.625, 33.625,
                                                                 33.625, 33.625, 33.625, 33.625, 33.625, 33.625, 33.625, 33.625,
                                                                 33.625, 33.625, 33.625, 33.625, 33.625, 33.625, 33.625, 33.625,
                                                                 33.625, 33.625, 33.625, 33.625, 33.625, 33.625, 33.625, 33.625,
                                                                 33.625, 33.625, 33.625, 33.625, 33.625, 33.625, 33.625, 33.625,
                                                                 33.625, 33.625, 33.625, 33.625, 33.625, 33.875, 33.875, 33.875,
                                                                 33.875, 33.875, 33.875, 33.875, 33.875, 33.875, 33.875, 33.875,
                                                                 33.875, 33.875, 33.875, 33.875, 33.875, 33.875, 33.875, 33.875,
                                                                 33.875, 33.875, 33.875, 33.875, 33.875, 33.875, 33.875, 33.875,
                                                                 33.875, 33.875, 33.875, 33.875, 33.875, 33.875, 33.875, 33.875,
                                                                 33.875, 33.875, 33.875, 33.875, 33.875, 33.875, 33.875, 33.875,
                                                                 33.875, 33.875, 33.875, 33.875, 33.875, 33.875, 33.875, 33.875,
                                                                 33.875, 33.875, 33.875, 33.875, 33.875, 33.875, 33.875, 33.875,
                                                                 33.875, 33.875, 33.875, 33.875, 33.875, 33.875, 33.875, 33.875,
                                                                 33.875, 33.875, 33.875, 33.875, 33.875, 33.875, 33.875, 33.875,
                                                                 33.875, 33.875, 33.875, 33.875, 33.875, 33.875, 33.875, 33.875,
                                                                 33.875, 33.875, 33.875, 33.875, 33.875, 33.875, 33.875, 33.875,
                                                                 33.875, 33.875, 33.875, 33.875, 33.875, 33.875, 33.875, 33.875,
                                                                 33.875, 33.875, 33.875, 34.125, 34.125, 34.125, 34.125, 34.125,
                                                                 34.125, 34.125, 34.125, 34.125, 34.125, 34.125, 34.125, 34.125,
                                                                 34.125, 34.125, 34.125, 34.125, 34.125, 34.125, 34.125, 34.125,
                                                                 34.125, 34.125, 34.125, 34.125, 34.125, 34.125, 34.125, 34.125,
                                                                 34.125, 34.125, 34.125, 34.125, 34.125, 34.125, 34.125, 34.125,
                                                                 34.125, 34.125, 34.125, 34.125, 34.125, 34.125, 34.125, 34.125,
                                                                 34.125, 34.125, 34.125, 34.125, 34.125, 34.125, 34.125, 34.125,
                                                                 34.125, 34.125, 34.125, 34.125, 34.125, 34.125, 34.125, 34.125,
                                                                 34.125, 34.125, 34.125, 34.125, 34.125, 34.125, 34.125, 34.125,
                                                                 34.125, 34.125, 34.125, 34.125, 34.125, 34.125, 34.125, 34.125,
                                                                 34.125, 34.125, 34.125, 34.125, 34.125, 34.125, 34.125, 34.125,
                                                                 34.125, 34.125, 34.125, 34.125, 34.125, 34.125, 34.125, 34.125,
                                                                 34.125, 34.125, 34.125, 34.125, 34.125, 34.125, 34.125, 34.125,
                                                                 34.125, 34.125, 34.375, 34.375, 34.375), cluster = c(1L, 1L,
                                                                                                                      1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
                                                                                                                      1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
                                                                                                                      1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 1L,
                                                                                                                      1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
                                                                                                                      1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 3L, 3L, 3L,
                                                                                                                      3L, 3L, 3L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
                                                                                                                      1L, 1L, 3L, 3L, 3L, 3L, 1L, 1L, 1L, 1L, 3L, 3L, 3L, 3L, 3L, 1L,
                                                                                                                      1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 3L, 3L, 3L,
                                                                                                                      1L, 1L, 1L, 3L, 3L, 3L, 3L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
                                                                                                                      1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 3L, 3L, 3L, 3L, 3L, 3L, 3L,
                                                                                                                      1L, 1L, 3L, 3L, 3L, 3L, 3L, 3L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
                                                                                                                      1L, 1L, 1L, 1L, 1L, 1L, 3L, 3L, 3L, 1L, 1L, 1L, 3L, 3L, 3L, 1L,
                                                                                                                      1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
                                                                                                                      1L, 1L, 1L, 3L, 3L, 3L, 3L, 2L, 2L, 3L, 3L, 1L, 2L, 2L, 3L, 3L,
                                                                                                                      3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
                                                                                                                      3L, 3L, 3L, 1L, 3L, 3L, 3L, 3L, 1L, 1L, 3L, 3L, 3L, 3L, 1L, 1L,
                                                                                                                      1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
                                                                                                                      1L, 1L, 1L, 3L, 3L, 3L, 2L, 2L, 2L, 2L, 3L, 1L, 1L, 1L, 2L, 2L,
                                                                                                                      2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 1L,
                                                                                                                      1L, 1L, 1L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 1L, 3L,
                                                                                                                      3L, 3L, 3L, 3L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
                                                                                                                      1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 3L, 3L, 3L, 3L, 3L, 2L,
                                                                                                                      2L, 2L, 2L, 3L, 3L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 3L,
                                                                                                                      3L, 3L, 3L, 3L, 3L, 2L, 2L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L,
                                                                                                                      2L, 2L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 1L, 1L, 1L, 3L, 3L, 3L, 1L,
                                                                                                                      1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
                                                                                                                      1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 3L, 3L, 3L, 3L, 3L, 2L, 2L,
                                                                                                                      2L, 2L, 2L, 2L, 2L, 2L, 3L, 3L, 1L, 1L, 1L, 3L, 3L, 3L, 3L, 2L,
                                                                                                                      2L, 3L, 3L, 3L, 2L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L, 2L, 2L, 2L,
                                                                                                                      2L, 2L, 2L, 3L, 3L, 3L, 3L, 3L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L,
                                                                                                                      3L, 3L, 3L, 1L, 1L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 1L, 1L, 1L, 1L,
                                                                                                                      1L, 1L, 1L, 2L, 3L, 3L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
                                                                                                                      1L, 1L, 1L, 1L, 1L, 3L, 3L, 3L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L,
                                                                                                                      4L, 2L, 2L, 3L, 1L, 1L, 3L, 3L, 3L, 3L, 3L, 2L, 2L, 2L, 2L, 2L,
                                                                                                                      2L, 3L, 3L, 3L, 2L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 2L, 2L, 2L, 2L,
                                                                                                                      2L, 2L, 2L, 2L, 3L, 3L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L,
                                                                                                                      2L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 1L, 1L, 1L,
                                                                                                                      1L, 1L, 4L, 4L, 2L, 2L, 3L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
                                                                                                                      1L, 1L, 1L, 1L, 1L, 3L, 2L, 2L, 2L, 2L, 2L, 2L, 4L, 4L, 4L, 4L,
                                                                                                                      4L, 4L, 2L, 2L, 3L, 3L, 3L, 3L, 3L, 2L, 2L, 2L, 2L, 2L, 2L, 2L,
                                                                                                                      2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L,
                                                                                                                      2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L,
                                                                                                                      2L, 2L, 2L, 2L, 3L, 3L, 3L, 2L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 1L,
                                                                                                                      1L, 1L, 1L, 4L, 4L, 4L, 2L, 2L, 3L, 3L, 1L, 1L, 1L, 1L, 1L, 1L,
                                                                                                                      1L, 1L, 1L, 1L, 3L, 3L, 3L, 2L, 2L, 2L, 2L, 4L, 4L, 4L, 4L, 4L,
                                                                                                                      4L, 4L, 4L, 4L, 2L, 2L, 3L, 3L, 3L, 2L, 2L, 2L, 2L, 2L, 4L, 4L,
                                                                                                                      4L, 4L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L,
                                                                                                                      2L, 2L, 2L, 4L, 4L, 4L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L,
                                                                                                                      2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L,
                                                                                                                      3L, 3L, 1L, 1L, 1L, 1L, 5L, 5L, 5L, 4L, 4L, 4L, 2L, 2L, 2L, 3L,
                                                                                                                      3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 2L, 3L, 2L, 2L, 2L, 2L,
                                                                                                                      4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 2L, 2L, 2L, 2L, 2L,
                                                                                                                      2L, 2L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 2L, 2L, 2L, 2L, 2L, 4L, 2L,
                                                                                                                      2L, 2L, 3L, 3L, 2L, 2L, 2L, 2L, 4L, 4L, 4L, 4L, 4L, 4L, 2L, 4L,
                                                                                                                      4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 2L, 2L, 2L, 2L, 2L, 2L,
                                                                                                                      2L, 2L, 2L, 2L, 2L, 2L, 2L, 3L, 3L, 1L, 1L, 1L, 5L, 5L, 5L, 4L,
                                                                                                                      4L, 4L, 4L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L, 2L, 2L,
                                                                                                                      2L, 2L, 2L, 2L, 2L, 2L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L,
                                                                                                                      4L, 4L, 2L, 2L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L,
                                                                                                                      4L, 2L, 2L, 4L, 2L, 2L, 2L, 3L, 3L, 3L, 3L, 2L, 2L, 2L, 4L, 4L,
                                                                                                                      4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L,
                                                                                                                      4L, 4L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 3L, 3L, 1L,
                                                                                                                      1L, 1L, 1L, 5L, 5L, 5L)), .Names = c("longitud", "latitud", "cluster"
                                                                                                                      ), row.names = c(NA, 1000L), class = "data.frame")
#-------------------------------------------------------#
bbox <- ggmap::make_bbox(datos$longitud, datos$latitud)
img_Mapa <- get_map(location = bbox, source = 'google', maptype = 'terrain', zoom = 18)


# Create raster from xyz data
dat.raster<-rasterFromXYZ(datos)
# Create Polygon
dat.poly <- rasterToPolygons(dat.raster, dissolve=TRUE)
# add to data a new column termed "id" composed of the rownames of data
dat.poly@data$id <- rownames(dat.poly@data)

# create a data.frame from our spatial object
datPoints <- fortify(dat.poly, region = "id")

# merge the "fortified" data with the data from our spatial object
datDF <- merge(datPoints, dat.poly@data, by = "id")

dat.poly@data$id <- rownames(dat.poly@data)

datPoints <- fortify(dat.poly, region = "id")
datDF <- merge(datPoints, dat.poly@data, by = "id")

# Map settings
# Prepare map coastline
if (!rgeosStatus()) gpclibPermit()

# path to the GSHHS maps on my computer
costa <- "/home/meteo/PROJECTES/VERSUS/DATA/GEO/gshhs_f.b"
#shore <- getRgshhsMap(costa, xlim = c(-15, 45), ylim = c(30, 50))

# Labels
ewbrks <- seq(-15,45,5)
nsbrks <- seq(30,50,5)

# Color palette
sst_paleta <- c("#4eb400","#a0ce00","#f7e400","#f8b600","#f88700","#f85900","#e82c0e","#d8001d","#ff0099","#b54cff","#998cff")

# Legend breaks
sst_breaks <- c(1,2,3,4,5,6,7,8,9,10,11)

# Plot map
p<-ggmap(img_Mapa, extent = "device") 
p+ggplot(data = datDF, aes(x=long, y=lat, group = group, fill = cluster)) +
  geom_polygon()  +
  #geom_polygon(data = shore, aes(x=long, y = lat, group = group), size=0.2, color = "black", fill = "burlywood2") +
  theme_bw() +
  coord_fixed(1.3) + scale_x_continuous(breaks = ewbrks,expand = c(0, 0)) +
  scale_y_continuous(breaks = ewbrks,expand = c(0, 0)) +
  scale_fill_gradientn(colours = sst_paleta, na.value = NA, limits=c(1,11), breaks = sst_breaks) 

